@startuml Activity_ConsulterFicheJeu
title Diagramme d'activite : Consulter la fiche d'un jeu

start

:Visiteur clique sur un jeu;

:Envoyer GET /games/:game_id;

:Recuperer informations jeu\nSELECT FROM game WHERE game_id = ?;

if (Jeu trouve ?) then (non)
  :Renvoyer 404;
  :Afficher erreur 404;
  stop
else (oui)
  partition "Recuperer donnees complementaires" {
    fork
      :Recuperer plateformes\nJOIN game_platform;
    fork again
      :Recuperer genres\nJOIN game_genre;
    fork again
      :Recuperer tags\nJOIN game_tag;
    fork again
      :Recuperer developpeurs\nJOIN game_developer;
    fork again
      :Recuperer editeurs\nJOIN game_publisher;
    fork again
      :Recuperer note moyenne\nAVG(rating);
    fork again
      :Recuperer derniers commentaires\nLIMIT 5;
    end fork
  }
  
  :Renvoyer 200 + fiche complete;
  :Afficher fiche du jeu;
  stop
endif

@enduml
